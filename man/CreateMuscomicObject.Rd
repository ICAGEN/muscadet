% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/objects.R
\name{CreateMuscomicObject}
\alias{CreateMuscomicObject}
\title{Create a \code{muscomic} object}
\usage{
CreateMuscomicObject(
  type = c("ATAC", "RNA"),
  mat_counts,
  features,
  allele_counts = NULL,
  label.omic = NULL,
  label.features = NULL
)
}
\arguments{
\item{type}{Type of single cell omic, either "ATAC" or "RNA"
(\code{character} string).}

\item{mat_counts}{Matrix of raw counts \emph{cells x features} (\code{matrix} or
\code{dgCMatrix}). Rows are cells and columns are features. (they must
correspond to the id column of \code{features})}

\item{features}{Data frame of features (peaks, genes...) coordinates on
genome (\code{data.frame}). It should contain 4 columns:
\describe{
\item{\code{CHROM}}{Chromosome names in character format, e.g. "15", "X" (\code{character}).}
\item{\code{start}}{Start positions (\code{integer}).}
\item{\code{end}}{End positions (\code{integer}).}
\item{\code{id}}{Unique identifiers, e.g. gene name "CDH1" or peak identifier
CHROM_start_end "1_1600338_1600838" (\code{character}). It should match the
feature identifiers as row names of \code{mat_counts}.}
}}

\item{allele_counts}{Data frame of allele counts at variant positions per
cell (\code{data.frame}). Variant positions can be either common single
nucleotide polymorphisms (SNPs) positions or individual-specific
heterozygous positions retrieved from bulk sequencing. The data frame format
is based on the Variant Calling Format (VCF), thereby it must contain the
following columns : \code{cell}, \code{CHROM}, \code{POS}, \code{REF}, \code{ALT}, \code{RD}, \code{AD}. See
\code{\link[=allele_counts]{allele_counts()}} for details.}

\item{label.omic}{Label for the single cell omic (\code{character} string). By
default "scATAC-seq" is used for "ATAC" type and "scRNA-seq" for "RNA"
type.}

\item{label.features}{Label for features (\code{character} string). By default
"peaks" is used for "ATAC" type and "genes" for "RNA" type.}
}
\value{
A \code{\link[=muscomic-class]{muscomic}} object.
}
\description{
Create a \code{\link[=muscomic-class]{muscomic}} object containing coverage and
(optionally) allelic count information for a single-cell omic dataset.
}
\examples{

# Minimal example
mat <- Matrix::sparseMatrix(
    i = c(1, 1, 2),
    j = c(1, 2, 1),
    x = c(5, 3, 2),
    dims = c(2, 2),
    dimnames = list(c("cell1", "cell2"), c("f1", "f2"))
)

features <- data.frame(
    CHROM = c("1", "1"),
    start = c(100, 200),
    end   = c(150, 250),
    id    = c("f1", "f2")
)

allele <- data.frame(
    cell = c("cell1", "cell2"),
    CHROM = c("1", "1"),
    POS = c(100, 200),
    REF = c("A", "G"),
    ALT = c("C", "T"),
    RD = c(10, 5),
    AD = c(3, 1)
)

muscomic <- CreateMuscomicObject(
    type = "ATAC",
    mat_counts = mat,
    features = features,
    allele_counts = allele
)

# On the example dataset
atac <- CreateMuscomicObject(
  type = "ATAC",
  mat_counts = t(mat_counts_atac_tumor),
  allele_counts = allele_counts_atac_tumor,
  features = peaks
)
atac

# without allele counts data (not required for clustering step)
atac2 <- CreateMuscomicObject(
  type = "ATAC",
  mat_counts = t(mat_counts_atac_tumor),
  features = peaks
)
atac2

}
\seealso{
\itemize{
\item \code{\link[=CreateMuscadetObject]{CreateMuscadetObject()}}
\item \linkS4class{muscomic}, \linkS4class{muscadet}
}
}
