<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Heatmap plot for muscadet object — heatmapMuscadet • muscadet</title><!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png"><link rel="icon" type="”image/svg+xml”" href="../favicon.svg"><link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png"><link rel="icon" sizes="any" href="../favicon.ico"><link rel="manifest" href="../site.webmanifest"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Heatmap plot for muscadet object — heatmapMuscadet"><meta name="description" content="This function generates a heatmap to visualize log R ratio (LRR) data
contained in muscadet objects. One heatmap is generated per
omic, rows are cells and columns are chromosomes, for muscadet object
containing multiple omics, the heatmaps are plotted horizontally aligned. The
cells can be clustered for a specific clustering partition following the
clustering step of muscadet object, or custom cluster assignments can be
used. Additionally, LRR values from bulk sequencing data can be plotted as an
annotation under the heatmaps."><meta property="og:description" content="This function generates a heatmap to visualize log R ratio (LRR) data
contained in muscadet objects. One heatmap is generated per
omic, rows are cells and columns are chromosomes, for muscadet object
containing multiple omics, the heatmaps are plotted horizontally aligned. The
cells can be clustered for a specific clustering partition following the
clustering step of muscadet object, or custom cluster assignments can be
used. Additionally, LRR values from bulk sequencing data can be plotted as an
annotation under the heatmaps."><meta property="og:image" content="https://icagen.github.io/muscadet/logo.png"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">muscadet</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/ICAGEN/muscadet/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Heatmap plot for <code>muscadet</code> object</h1>
      <small class="dont-index">Source: <a href="https://github.com/ICAGEN/muscadet/blob/main/R/plots.R" class="external-link"><code>R/plots.R</code></a></small>
      <div class="d-none name"><code>heatmapMuscadet.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>This function generates a heatmap to visualize log R ratio (LRR) data
contained in <code><a href="muscadet-class.html">muscadet</a></code> objects. One heatmap is generated per
omic, rows are cells and columns are chromosomes, for <code>muscadet</code> object
containing multiple omics, the heatmaps are plotted horizontally aligned. The
cells can be clustered for a specific clustering partition following the
clustering step of <code>muscadet</code> object, or custom cluster assignments can be
used. Additionally, LRR values from bulk sequencing data can be plotted as an
annotation under the heatmaps.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">heatmapMuscadet</span><span class="op">(</span></span>
<span>  <span class="va">x</span>,</span>
<span>  filename <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  partition <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  clusters <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  add_bulk_lrr <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  show_missing <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  averages <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  title <span class="op">=</span> <span class="st">""</span>,</span>
<span>  row_annots <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  white_scale <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.3</span>, <span class="fl">0.7</span><span class="op">)</span>,</span>
<span>  colors <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  png_res <span class="op">=</span> <span class="fl">300</span>,</span>
<span>  quiet <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-x">x<a class="anchor" aria-label="anchor" href="#arg-x"></a></dt>
<dd><p>A <code><a href="muscadet-class.html">muscadet</a></code> object containing LRR data for all omics
(with <code><a href="computeLogRatio.html">computeLogRatio()</a></code>) and clustering data (with
<code><a href="clusterMuscadet.html">clusterMuscadet()</a></code>) (<code>muscadet</code>).</p></dd>


<dt id="arg-filename">filename<a class="anchor" aria-label="anchor" href="#arg-filename"></a></dt>
<dd><p>(Optional) Character string specifying the file path to save
the heatmap image in the PNG (if it ends by .png) or PDF (if it ends by
.pdf) format (<code>character</code> string).</p></dd>


<dt id="arg-partition">partition<a class="anchor" aria-label="anchor" href="#arg-partition"></a></dt>
<dd><p>(Optional) Value specifying the clustering partition to
plot (<code>numeric</code> or <code>character</code>). It should be either the resolution or the
number of cluster (k) used for clustering depending on the clustering
method (<code>res_range</code> or <code>k_range</code> with <code><a href="clusterMuscadet.html">clusterMuscadet()</a></code>).
If both <code>partition</code> and <code>clusters</code> arguments are <code>NULL</code> (default), the
assigned clusters for CNA calling (<code>x@cnacalling$cluster</code>) are used if
available in <code>x</code> (see <code><a href="assignClusters.html">assignClusters()</a></code>).</p></dd>


<dt id="arg-clusters">clusters<a class="anchor" aria-label="anchor" href="#arg-clusters"></a></dt>
<dd><p>(Optional) A custom named vector of cluster assignments
(<code>integer</code> named vector). Names must corresponds to cell names within the
muscadet object <code>x</code>. If it contains less cells than the muscadet object
<code>x</code>, the missing cells are filtered out and not displayed in the heatmap.
If <code>show_missing = FALSE</code> only the provided cells with data in all omics
will be displayed. If both <code>partition</code> and <code>clusters</code> arguments are <code>NULL</code>
(default), the assigned clusters for CNA calling (<code>x@cnacalling$cluster</code>)
are used if available in <code>x</code> (see <code><a href="assignClusters.html">assignClusters()</a></code>).</p></dd>


<dt id="arg-add-bulk-lrr">add_bulk_lrr<a class="anchor" aria-label="anchor" href="#arg-add-bulk-lrr"></a></dt>
<dd><p>Logical. If <code>TRUE</code> (default), adds bulk log R ratio (LRR) data as
annotation if available in the muscadet object.</p></dd>


<dt id="arg-show-missing">show_missing<a class="anchor" aria-label="anchor" href="#arg-show-missing"></a></dt>
<dd><p>Logical. If <code>TRUE</code> (default), missing cells (i.e., cells
with missing data in at least one omic) are displayed in the heatmaps.</p></dd>


<dt id="arg-averages">averages<a class="anchor" aria-label="anchor" href="#arg-averages"></a></dt>
<dd><p>Logical. If <code>TRUE</code>, plots the average log R ratio per
cluster. Default is <code>FALSE</code>.</p></dd>


<dt id="arg-title">title<a class="anchor" aria-label="anchor" href="#arg-title"></a></dt>
<dd><p>Character string for the title of the heatmap (<code>character</code>
string). Default is an empty character string.</p></dd>


<dt id="arg-row-annots">row_annots<a class="anchor" aria-label="anchor" href="#arg-row-annots"></a></dt>
<dd><p>Optional. A list of <a href="https://rdrr.io/pkg/ComplexHeatmap/man/HeatmapAnnotation-class.html" class="external-link">HeatmapAnnotation</a> objects from
the <a href="https://rdrr.io/pkg/ComplexHeatmap/man/ComplexHeatmap-package.html" class="external-link">ComplexHeatmap-package</a> package, specifying row annotations to add on
left part of the heatmap. Each element in the list must be of class
<a href="https://rdrr.io/pkg/ComplexHeatmap/man/HeatmapAnnotation-class.html" class="external-link">HeatmapAnnotation</a>, must be a row annotation (using
<code><a href="https://rdrr.io/pkg/ComplexHeatmap/man/rowAnnotation.html" class="external-link">rowAnnotation()</a></code> or <code><a href="https://rdrr.io/pkg/ComplexHeatmap/man/HeatmapAnnotation.html" class="external-link">HeatmapAnnotation()</a></code> with <code>which = 'row'</code>), and must
have a unique name (<code>name</code> argument in <code><a href="https://rdrr.io/pkg/ComplexHeatmap/man/rowAnnotation.html" class="external-link">rowAnnotation()</a></code> or
<code><a href="https://rdrr.io/pkg/ComplexHeatmap/man/HeatmapAnnotation.html" class="external-link">HeatmapAnnotation()</a></code>). If <code>averages = FALSE</code>, annotations must concern
cells, while if <code>averages = TRUE</code> they must concern clusters. Default is
<code>NULL</code>, no row annotations is added.</p></dd>


<dt id="arg-white-scale">white_scale<a class="anchor" aria-label="anchor" href="#arg-white-scale"></a></dt>
<dd><p>Numeric vector of length 2 or a list of numeric vectors
(<code>numeric</code> vector or <code>list</code>).</p><ul><li><p>If a numeric vector of length 2, the same white color boundaries are
applied to all omics in the muscadet object. E.g. <code>c(0.3, 0.7)</code> (default).</p></li>
<li><p>If a list (named or not with omics name), it must have the same length as
the number of omics in the muscadet object, where each vector element
applies the white color boundaries for a specific omic. E.g. <code>list(c(0.3, 0.7), c(0.4, 0.6))</code> uses 0.3 and 0.7 quantiles of LRR ref data for the 1st
omic heatmap, and 0.4 and 0.6 quantiles for the second.</p>
<p>Values of the vectors must be between 0 and 1, specifying the quantiles of
the LRR reference data that define the boundaries for the white color in
each heatmap. LRR values falling within this range are considered close to
the majority of the LRR reference data, indicating no significant gain or
loss of coverage, and are represented as white on the heatmap. Default is
<code>c(0.3, 0.7)</code>.</p></li>
</ul></dd>


<dt id="arg-colors">colors<a class="anchor" aria-label="anchor" href="#arg-colors"></a></dt>
<dd><p>Vector of colors for the cluster annotation (<code>character</code>
vector). If <code>NULL</code> (default), it uses predefined colors.</p></dd>


<dt id="arg-png-res">png_res<a class="anchor" aria-label="anchor" href="#arg-png-res"></a></dt>
<dd><p>Resolution in ppi for <code><a href="https://rdrr.io/r/grDevices/png.html" class="external-link">grDevices::png()</a></code> if <code>filename</code> ends
with the .png extension (<code>numeric</code>). Default is <code>300</code>.</p></dd>


<dt id="arg-quiet">quiet<a class="anchor" aria-label="anchor" href="#arg-quiet"></a></dt>
<dd><p>Logical. If <code>TRUE</code>, suppresses informative messages during
execution. Default is <code>FALSE</code>.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A list containing:</p><ul><li><p><code>plot</code>: A <code><a href="https://rdrr.io/r/grid/grid.grob.html" class="external-link">gTree</a></code> object created with <code><a href="https://rdrr.io/r/grid/grid.grab.html" class="external-link">grid::grid.grab()</a></code> (<code><a href="https://rdrr.io/r/grid/grid.grob.html" class="external-link">gTree</a></code>).</p></li>
<li><p><code>width</code>: Width of the heatmap plot in mm (<code><a href="https://rdrr.io/r/grid/unit.html" class="external-link">unit</a></code>).</p></li>
<li><p><code>height</code>: Height of the heatmap plot in mm (<code><a href="https://rdrr.io/r/grid/unit.html" class="external-link">unit</a></code>).</p></li>
</ul><p>If the <code>filename</code> argument is provided, the heatmap is directly saved as a
PNG image at the provided path.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span> <span class="co"># \dontrun{</span></span></span>
<span class="r-in"><span><span class="co"># Load example muscadet object</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">muscadet_obj</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># --- Method "seurat" ---</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">muscadet_obj</span><span class="op">$</span><span class="va">clustering</span><span class="op">$</span><span class="va">params</span><span class="op">$</span><span class="va">method</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Perform clustering if not already done</span></span></span>
<span class="r-in"><span><span class="co"># muscadet_obj &lt;- clusterMuscadet(</span></span></span>
<span class="r-in"><span><span class="co">#     x = muscadet_obj,</span></span></span>
<span class="r-in"><span><span class="co">#     method = "seurat",</span></span></span>
<span class="r-in"><span><span class="co">#     res_range = c(0.6, 0.8),</span></span></span>
<span class="r-in"><span><span class="co">#     dims_list = list(1:10, 1:10),</span></span></span>
<span class="r-in"><span><span class="co">#     knn_seurat = 10, # adapted for low number of cells in example data</span></span></span>
<span class="r-in"><span><span class="co">#     knn_range_seurat = 30 # adapted for low number of cells in example data</span></span></span>
<span class="r-in"><span><span class="co"># )</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Plot a single partition</span></span></span>
<span class="r-in"><span><span class="fu">heatmapMuscadet</span><span class="op">(</span><span class="va">muscadet_obj</span>,</span></span>
<span class="r-in"><span>                filename <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="st">"heatmap_res0.6.png"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                partition <span class="op">=</span> <span class="fl">0.6</span>,</span></span>
<span class="r-in"><span>                show_missing <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Loop over partitions</span></span></span>
<span class="r-in"><span><span class="kw">for</span> <span class="op">(</span><span class="va">p</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">muscadet_obj</span><span class="op">$</span><span class="va">clustering</span><span class="op">$</span><span class="va">clusters</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>    <span class="va">filename</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"heatmap_res"</span>, <span class="va">p</span>, <span class="st">".png"</span><span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="va">title</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>        <span class="st">"Example |"</span>,</span></span>
<span class="r-in"><span>        <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"method="</span>, <span class="va">muscadet_obj</span><span class="op">$</span><span class="va">clustering</span><span class="op">$</span><span class="va">params</span><span class="op">[[</span><span class="st">"method"</span><span class="op">]</span><span class="op">]</span><span class="op">)</span>, <span class="st">"|"</span>,</span></span>
<span class="r-in"><span>        <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"omics="</span>, <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">muscadet_obj</span><span class="op">$</span><span class="va">clustering</span><span class="op">$</span><span class="va">params</span><span class="op">[[</span><span class="st">"omics"</span><span class="op">]</span><span class="op">]</span>, collapse <span class="op">=</span> <span class="st">","</span><span class="op">)</span><span class="op">)</span>, <span class="st">"|"</span>,</span></span>
<span class="r-in"><span>        <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"dims="</span>, <span class="st">"1:10,1:10"</span><span class="op">)</span>, <span class="st">"|"</span>,</span></span>
<span class="r-in"><span>        <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"res="</span>, <span class="va">p</span><span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="fu">heatmapMuscadet</span><span class="op">(</span><span class="va">muscadet_obj</span>, <span class="va">filename</span>, partition <span class="op">=</span> <span class="va">p</span>, title <span class="op">=</span> <span class="va">title</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># --- Plot Averages per Clusters ---</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu">heatmapMuscadet</span><span class="op">(</span><span class="va">muscadet_obj</span>,</span></span>
<span class="r-in"><span>                filename <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="st">"heatmap_res0.6_averages.png"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                partition <span class="op">=</span> <span class="fl">0.6</span>,</span></span>
<span class="r-in"><span>                averages <span class="op">=</span> <span class="cn">TRUE</span>,</span></span>
<span class="r-in"><span>                add_bulk_lrr <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># --- Add Row Annotation ---</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="st"><a href="https://github.com/jokergoo/ComplexHeatmap" class="external-link">"ComplexHeatmap"</a></span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Define example cell annotation</span></span></span>
<span class="r-in"><span><span class="va">muscadet_cells</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/funprog.html" class="external-link">Reduce</a></span><span class="op">(</span><span class="va">union</span>, <span class="fu">SeuratObject</span><span class="fu">::</span><span class="fu"><a href="https://satijalab.github.io/seurat-object/reference/Cells.html" class="external-link">Cells</a></span><span class="op">(</span><span class="va">muscadet_obj</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">cells_origin</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/setNames.html" class="external-link">setNames</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>    <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"sample1"</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">ceiling</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">muscadet_cells</span><span class="op">)</span> <span class="op">/</span> <span class="fl">2</span><span class="op">)</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"sample2"</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">floor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">muscadet_cells</span><span class="op">)</span> <span class="op">/</span> <span class="fl">2</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="op">)</span>,</span></span>
<span class="r-in"><span>    <span class="va">muscadet_cells</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">cells_origin</span> <span class="op">&lt;-</span> <span class="va">cells_origin</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/sort.html" class="external-link">sort</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">cells_origin</span><span class="op">)</span><span class="op">)</span><span class="op">]</span></span></span>
<span class="r-in"><span><span class="co"># IMPORTANT: annotation names (cells) must be sorted to match heatmap</span></span></span>
<span class="r-in"><span><span class="co"># matrices (column names of log ratio matrix are sorted in heatmapMuscadet())</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Create row annotation</span></span></span>
<span class="r-in"><span><span class="va">ha</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/ComplexHeatmap/man/rowAnnotation.html" class="external-link">rowAnnotation</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>    annot <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/ComplexHeatmap/man/anno_simple.html" class="external-link">anno_simple</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>        <span class="va">cells_origin</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/sort.html" class="external-link">sort</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">cells_origin</span><span class="op">)</span><span class="op">)</span><span class="op">]</span>,</span></span>
<span class="r-in"><span>        col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"sample1"</span> <span class="op">=</span> <span class="st">"cadetblue3"</span>, <span class="st">"sample2"</span> <span class="op">=</span> <span class="st">"orchid3"</span><span class="op">)</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    name <span class="op">=</span> <span class="st">"origin"</span>, <span class="co"># unique name</span></span></span>
<span class="r-in"><span>    annotation_label <span class="op">=</span> <span class="st">"origin"</span>, <span class="co"># label displayed on heatmap</span></span></span>
<span class="r-in"><span>    annotation_name_gp <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/gpar.html" class="external-link">gpar</a></span><span class="op">(</span>fontsize <span class="op">=</span> <span class="fl">10</span><span class="op">)</span> <span class="co"># change font size</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Plot heatmap with supplementary row annotation</span></span></span>
<span class="r-in"><span><span class="fu">heatmapMuscadet</span><span class="op">(</span><span class="va">muscadet_obj</span>,</span></span>
<span class="r-in"><span>                filename <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="st">"heatmap_res0.6_annot.png"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                partition <span class="op">=</span> <span class="fl">0.6</span>,</span></span>
<span class="r-in"><span>                row_annots <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">ha</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># --- Add Row Annotation for averages ---</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="st"><a href="https://github.com/jokergoo/ComplexHeatmap" class="external-link">"ComplexHeatmap"</a></span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Define example cluster annotation</span></span></span>
<span class="r-in"><span><span class="va">clus</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/setNames.html" class="external-link">setNames</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"annot1"</span>, <span class="st">"annot2"</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span> <span class="co"># 2 clusters for partition 0.6</span></span></span>
<span class="r-in"><span><span class="va">clus</span> <span class="op">&lt;-</span> <span class="va">clus</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/order.html" class="external-link">order</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">clus</span><span class="op">)</span><span class="op">)</span><span class="op">]</span></span></span>
<span class="r-in"><span><span class="co"># IMPORTANT: annotation names (clusters) must be sorted to match heatmap</span></span></span>
<span class="r-in"><span><span class="co"># matrices (column names of log ratio averages matrix are sorted in heatmapMuscadet())</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Create row annotation</span></span></span>
<span class="r-in"><span><span class="va">ha2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/ComplexHeatmap/man/rowAnnotation.html" class="external-link">rowAnnotation</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>    annot <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/ComplexHeatmap/man/anno_simple.html" class="external-link">anno_simple</a></span><span class="op">(</span><span class="va">clus</span>, col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"annot1"</span> <span class="op">=</span> <span class="st">"tomato"</span>, <span class="st">"annot2"</span> <span class="op">=</span> <span class="st">"gold2"</span><span class="op">)</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    name <span class="op">=</span> <span class="st">"annot"</span>, <span class="co"># unique name</span></span></span>
<span class="r-in"><span>    annotation_label <span class="op">=</span> <span class="st">"annot"</span>, <span class="co"># label displayed on heatmap</span></span></span>
<span class="r-in"><span>    annotation_name_gp <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/gpar.html" class="external-link">gpar</a></span><span class="op">(</span>fontsize <span class="op">=</span> <span class="fl">10</span><span class="op">)</span> <span class="co"># change font size</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">heatmapMuscadet</span><span class="op">(</span><span class="va">muscadet_obj</span>,</span></span>
<span class="r-in"><span>                averages <span class="op">=</span> <span class="cn">TRUE</span>,</span></span>
<span class="r-in"><span>                filename <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="st">"heatmap_res0.6_annot_averages.png"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                partition <span class="op">=</span> <span class="fl">0.6</span>,</span></span>
<span class="r-in"><span>                row_annots <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">ha2</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># --- Method "hclust" ---</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Perform clustering if not already done</span></span></span>
<span class="r-in"><span><span class="va">muscadet_obj2</span> <span class="op">&lt;-</span> <span class="fu"><a href="clusterMuscadet.html">clusterMuscadet</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>    x <span class="op">=</span> <span class="va">muscadet_obj</span>,</span></span>
<span class="r-in"><span>    method <span class="op">=</span> <span class="st">"hclust"</span>,</span></span>
<span class="r-in"><span>    k_range <span class="op">=</span> <span class="fl">3</span><span class="op">:</span><span class="fl">5</span>,</span></span>
<span class="r-in"><span>    dist_method <span class="op">=</span> <span class="st">"euclidean"</span>,</span></span>
<span class="r-in"><span>    hclust_method <span class="op">=</span> <span class="st">"ward.D"</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">muscadet_obj2</span><span class="op">$</span><span class="va">clustering</span><span class="op">$</span><span class="va">params</span><span class="op">$</span><span class="va">method</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Plot a single partition</span></span></span>
<span class="r-in"><span><span class="fu">heatmapMuscadet</span><span class="op">(</span><span class="va">muscadet_obj2</span>,</span></span>
<span class="r-in"><span>                filename <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="st">"heatmap_k3.png"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                partition <span class="op">=</span> <span class="fl">3</span>,</span></span>
<span class="r-in"><span>                show_missing <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Loop over partitions</span></span></span>
<span class="r-in"><span><span class="kw">for</span> <span class="op">(</span><span class="va">p</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">muscadet_obj2</span><span class="op">$</span><span class="va">clustering</span><span class="op">$</span><span class="va">clusters</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>    <span class="va">filename</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"heatmap_k"</span>, <span class="va">p</span>, <span class="st">".png"</span><span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="va">title</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>        <span class="st">"Example |"</span>,</span></span>
<span class="r-in"><span>        <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"method="</span>, <span class="va">muscadet_obj2</span><span class="op">$</span><span class="va">clustering</span><span class="op">$</span><span class="va">params</span><span class="op">[[</span><span class="st">"method"</span><span class="op">]</span><span class="op">]</span><span class="op">)</span>, <span class="st">"|"</span>,</span></span>
<span class="r-in"><span>        <span class="va">muscadet_obj2</span><span class="op">$</span><span class="va">clustering</span><span class="op">$</span><span class="va">params</span><span class="op">[[</span><span class="st">"dist_method"</span><span class="op">]</span><span class="op">]</span>,</span></span>
<span class="r-in"><span>        <span class="va">muscadet_obj2</span><span class="op">$</span><span class="va">clustering</span><span class="op">$</span><span class="va">params</span><span class="op">[[</span><span class="st">"hclust_method"</span><span class="op">]</span><span class="op">]</span>, <span class="st">"|"</span>,</span></span>
<span class="r-in"><span>        <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"weights="</span>,</span></span>
<span class="r-in"><span>               <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">muscadet_obj2</span><span class="op">$</span><span class="va">clustering</span><span class="op">$</span><span class="va">params</span><span class="op">[[</span><span class="st">"weights"</span><span class="op">]</span><span class="op">]</span>, collapse <span class="op">=</span> <span class="st">","</span><span class="op">)</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>        <span class="st">"|"</span>,</span></span>
<span class="r-in"><span>        <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"k="</span>, <span class="va">p</span><span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>    <span class="fu">heatmapMuscadet</span><span class="op">(</span><span class="va">muscadet_obj2</span>, <span class="va">filename</span>, partition <span class="op">=</span> <span class="va">p</span>, title <span class="op">=</span> <span class="va">title</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-in"><span><span class="op">}</span> <span class="co"># }</span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Marie Denoulet, Céline Vallot, Eric Letouzé.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.2.</p>
</div>

    </footer></div>





  </body></html>

