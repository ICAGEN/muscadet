<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Assign a cluster assignment to a muscadet object — assignClusters • muscadet</title><!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png"><link rel="icon" type="”image/svg+xml”" href="../favicon.svg"><link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png"><link rel="icon" sizes="any" href="../favicon.ico"><link rel="manifest" href="../site.webmanifest"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Assign a cluster assignment to a muscadet object — assignClusters"><meta name="description" content="Add the user selected cluster assignments to cells in a
muscadet object. This function allows the user to choose the
cluster assignments they consider to fit the data and their requirements, or
cluster assignments based on other data and methods."><meta property="og:description" content="Add the user selected cluster assignments to cells in a
muscadet object. This function allows the user to choose the
cluster assignments they consider to fit the data and their requirements, or
cluster assignments based on other data and methods."><meta property="og:image" content="https://icagen.github.io/muscadet/logo.png"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">muscadet</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/ICAGEN/muscadet/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Assign a cluster assignment to a <code>muscadet</code> object</h1>
      <small class="dont-index">Source: <a href="https://github.com/ICAGEN/muscadet/blob/main/R/utils.R" class="external-link"><code>R/utils.R</code></a></small>
      <div class="d-none name"><code>assignClusters.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Add the user selected cluster assignments to cells in a
<code><a href="muscadet-class.html">muscadet</a></code> object. This function allows the user to choose the
cluster assignments they consider to fit the data and their requirements, or
cluster assignments based on other data and methods.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">assignClusters</span><span class="op">(</span></span>
<span>  <span class="va">x</span>,</span>
<span>  partition <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  clusters <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  mapping <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  redo_imputation <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  knn_imp <span class="op">=</span> <span class="fl">10</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-x">x<a class="anchor" aria-label="anchor" href="#arg-x"></a></dt>
<dd><p>A <code><a href="muscadet-class.html">muscadet</a></code> object (<code>muscadet</code>).</p></dd>


<dt id="arg-partition">partition<a class="anchor" aria-label="anchor" href="#arg-partition"></a></dt>
<dd><p>Value specifying the clustering partition to choose from the
muscadet object (<code>numeric</code> or <code>character</code>). It should be either the resolution or the
k number of cluster (k) used for clustering depending on the clustering
method (<code>res_range</code> or <code>k_range</code> with <code><a href="clusterMuscadet.html">clusterMuscadet()</a></code>).
Should be provided if <code>clusters</code> is <code>NULL</code>.</p></dd>


<dt id="arg-clusters">clusters<a class="anchor" aria-label="anchor" href="#arg-clusters"></a></dt>
<dd><p>A custom named vector of cluster assignments (<code>vector</code>). The
vector names must match cell names in the muscadet object <code>x</code>, at least
cluster assignments for all common cells must be provided if
<code>redo_imputation</code> is set to true, otherwise, all cells within the muscadet
object <code>x</code> must be provided. Should be provided if <code>partition</code> is <code>NULL</code>.</p></dd>


<dt id="arg-mapping">mapping<a class="anchor" aria-label="anchor" href="#arg-mapping"></a></dt>
<dd><p>Optional named vector specifying how to remap cluster values
(<code>vector</code>). The names of the vector correspond to the original cluster
values, and the values are the remapped cluster values. For example, <code>c("1" = 1, "2" = 1, "3" = 2, "4" = 3)</code> would merge clusters 1 and 2 into 1,
cluster 3 into 2, and cluster 4 into 3.</p></dd>


<dt id="arg-redo-imputation">redo_imputation<a class="anchor" aria-label="anchor" href="#arg-redo-imputation"></a></dt>
<dd><p>Logical. If <code>TRUE</code> (default), reruns the imputation
process to assign clusters to cells with missing data. This ensures that
imputed clusters are updated if the clustering has changed due to remapping
or to the use of custom clusters.</p></dd>


<dt id="arg-knn-imp">knn_imp<a class="anchor" aria-label="anchor" href="#arg-knn-imp"></a></dt>
<dd><p>Integer specifying the number of nearest neighbors cells to
use for imputation (<code>integer</code>). Must be a positive integer. Default is
<code>10</code>.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A <code><a href="muscadet-class.html">muscadet</a></code> object updated with the user chosen cluster
assignments in <code>muscadet_obj$cnacalling$clusters</code>.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>

<ul><li><p>The clusters can be taken directly from the <code>muscadet</code> object clustering
results with setting the <code>parition</code> argument (e.g.
<code>muscadet_obj$clustering$clusters[["0.8"]]</code> for res=<code>0.8</code>).</p></li>
<li><p>A custom vector of cluster assignments
can be attributed using the <code>clusters</code> argument.</p></li>
<li><p>Either way, the clusters assignments can be rearranged using the <code>mapping</code>
argument.</p></li>
</ul></div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span> <span class="co"># \dontrun{</span></span></span>
<span class="r-in"><span><span class="co"># Load example muscadet object</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">muscadet_obj</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Select clustering result for partition = 0.6</span></span></span>
<span class="r-in"><span><span class="va">muscadet_obj</span> <span class="op">&lt;-</span> <span class="fu">assignClusters</span><span class="op">(</span><span class="va">muscadet_obj</span>, partition <span class="op">=</span> <span class="fl">0.6</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/table.html" class="external-link">table</a></span><span class="op">(</span><span class="va">muscadet_obj</span><span class="op">$</span><span class="va">cnacalling</span><span class="op">$</span><span class="va">clusters</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Assign custom clusters</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">42</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">cell_names</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/funprog.html" class="external-link">Reduce</a></span><span class="op">(</span><span class="va">union</span>, <span class="fu">SeuratObject</span><span class="fu">::</span><span class="fu"><a href="https://satijalab.github.io/seurat-object/reference/Cells.html" class="external-link">Cells</a></span><span class="op">(</span><span class="va">muscadet_obj</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">n1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">cell_names</span><span class="op">)</span>, <span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">n2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">cell_names</span><span class="op">)</span> <span class="op">-</span> <span class="va">n1</span></span></span>
<span class="r-in"><span><span class="va">custom_clusters</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/setNames.html" class="external-link">setNames</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep.int</a></span><span class="op">(</span><span class="fl">1</span>, <span class="va">n1</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep.int</a></span><span class="op">(</span><span class="fl">2</span>, <span class="va">n2</span><span class="op">)</span><span class="op">)</span>, <span class="va">cell_names</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/table.html" class="external-link">table</a></span><span class="op">(</span><span class="va">custom_clusters</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">muscadet_obj</span> <span class="op">&lt;-</span> <span class="fu">assignClusters</span><span class="op">(</span><span class="va">muscadet_obj</span>, clusters <span class="op">=</span> <span class="va">custom_clusters</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/table.html" class="external-link">table</a></span><span class="op">(</span><span class="va">muscadet_obj</span><span class="op">$</span><span class="va">cnacalling</span><span class="op">$</span><span class="va">clusters</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Assign clusters with remapping</span></span></span>
<span class="r-in"><span><span class="co"># example to remap from partition=0.8 with merging of clusters 2 and 3</span></span></span>
<span class="r-in"><span><span class="va">clusters</span> <span class="op">&lt;-</span> <span class="va">muscadet_obj</span><span class="op">$</span><span class="va">clustering</span><span class="op">$</span><span class="va">clusters</span><span class="op">[[</span><span class="st">"0.8"</span><span class="op">]</span><span class="op">]</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/table.html" class="external-link">table</a></span><span class="op">(</span><span class="va">clusters</span><span class="op">)</span> <span class="co"># 3 clusters</span></span></span>
<span class="r-in"><span><span class="va">mapping</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"1"</span> <span class="op">=</span> <span class="fl">1</span>, <span class="st">"2"</span> <span class="op">=</span> <span class="fl">2</span>, <span class="st">"3"</span> <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="co"># remap to 2 clusters</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">muscadet_obj</span> <span class="op">&lt;-</span> <span class="fu">assignClusters</span><span class="op">(</span><span class="va">muscadet_obj</span>, clusters <span class="op">=</span> <span class="va">clusters</span>, mapping <span class="op">=</span> <span class="va">mapping</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/table.html" class="external-link">table</a></span><span class="op">(</span><span class="va">muscadet_obj</span><span class="op">$</span><span class="va">cnacalling</span><span class="op">$</span><span class="va">clusters</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># check original and remapped clusters</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/table.html" class="external-link">table</a></span><span class="op">(</span><span class="va">clusters</span>, <span class="va">muscadet_obj</span><span class="op">$</span><span class="va">cnacalling</span><span class="op">$</span><span class="va">clusters</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">muscadet_obj</span> <span class="op">&lt;-</span> <span class="fu">assignClusters</span><span class="op">(</span><span class="va">muscadet_obj</span>, partition <span class="op">=</span> <span class="fl">0.8</span>, mapping <span class="op">=</span> <span class="va">mapping</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/table.html" class="external-link">table</a></span><span class="op">(</span><span class="va">muscadet_obj</span><span class="op">$</span><span class="va">cnacalling</span><span class="op">$</span><span class="va">clusters</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># check original and remapped clusters</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/table.html" class="external-link">table</a></span><span class="op">(</span><span class="va">muscadet_obj</span><span class="op">$</span><span class="va">clustering</span><span class="op">$</span><span class="va">clusters</span><span class="op">[[</span><span class="st">"0.8"</span><span class="op">]</span><span class="op">]</span>,</span></span>
<span class="r-in"><span>      <span class="va">muscadet_obj</span><span class="op">$</span><span class="va">cnacalling</span><span class="op">$</span><span class="va">clusters</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Visualize clusters on heatmap</span></span></span>
<span class="r-in"><span><span class="fu"><a href="heatmapMuscadet.html">heatmapMuscadet</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>    <span class="va">muscadet_obj</span>,</span></span>
<span class="r-in"><span>    partition <span class="op">=</span> <span class="fl">0.8</span>,</span></span>
<span class="r-in"><span>    filename <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="st">"heatmap_muscadet_res0.8.png"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    title <span class="op">=</span> <span class="st">"Example sample | res=0.8"</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="heatmapMuscadet.html">heatmapMuscadet</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>    <span class="va">muscadet_obj</span>,</span></span>
<span class="r-in"><span>    clusters <span class="op">=</span> <span class="va">muscadet_obj</span><span class="op">$</span><span class="va">cnacalling</span><span class="op">$</span><span class="va">clusters</span>,</span></span>
<span class="r-in"><span>    filename <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="st">"heatmap_muscadet_custom_res0.8.png"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    title <span class="op">=</span> <span class="st">"Example sample | rearranged clusters from res=0.8"</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span> <span class="co"># }</span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Marie Denoulet, Céline Vallot, Eric Letouzé.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.2.</p>
</div>

    </footer></div>





  </body></html>

